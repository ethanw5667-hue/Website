<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Astro Sky Solver — Ethan Wang</title>
<meta name="description" content="Star detection, plate solving, Gaia cross-match, and limiting-magnitude sky quality from a single night-sky image.">
<link rel="stylesheet" href="../styles.css">
<style>
  .backlink{display:inline-block;margin-bottom:10px}
  .project-hero{display:flex;justify-content:space-between;align-items:flex-end;gap:20px}
  .project-hero .meta{display:flex;gap:8px;flex-wrap:wrap}
  .chip{border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-weight:600;color:var(--penn-blue);background:#fff}
  .figure{margin:16px 0}
  .figure img{width:100%;height:auto;border:1px solid var(--line);border-radius:12px;box-shadow:var(--shadow)}
  .figure small{display:block;color:var(--muted);margin-top:6px}
  .callout{border-left:4px solid var(--penn-blue);background:var(--paper-alt);padding:12px 14px;border-radius:10px;margin:14px 0}
  .slides-wrap{margin:14px 0;border:1px solid var(--line);border-radius:12px;overflow:hidden;box-shadow:var(--shadow)}
  .slides-toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;justify-content:flex-start;padding:10px;background:var(--paper-alt);border-bottom:1px solid var(--line)}
  .slides-embed{width:100%;height:min(85vh,900px);background:#fff}
  .refs{font-size:.95rem;color:var(--muted)}
  .code{font-family:ui-monospace,SFMono-Regular,Consolas,monospace;color:var(--penn-blue)}
</style>
</head>
<body>
<div class="progress"></div>

<header class="site-header">
  <div class="container navbar">
    <a class="brand" href="../index.html" aria-label="Home">
      <span class="brand-badge" aria-hidden="true"></span>
      <span class="brand-name">Ethan&nbsp;Wang</span>
    </a>
    <button class="menu" aria-controls="mainnav" aria-expanded="false">Menu</button>
    <nav id="mainnav" class="nav">
      <a href="../about.html">About</a>
      <a class="active" href="../projects.html">Projects</a>
      <a href="../resume.html">Resume</a>
      <a href="../cv.html">CV</a>
      <a href="../contact.html" class="btn ghost">Contact</a>
    </nav>
  </div>
</header>

<main>
  <section class="section"><div class="container reveal">
    <a class="backlink" href="./index.html">← Back to Projects</a>
  
      <div class="project-hero">
        <div>
          <div class="overline">Case study</div>
          <h2>Astro Sky Solver — star ID & sky quality from one photo</h2>
        </div>
        <div class="meta">
          <span class="chip">Astrophotography</span>
          <span class="chip">Computer Vision</span>
          <span class="chip">Python</span>
        </div>
      </div>

      <p class="lead">
        A lightweight pipeline that takes a night-sky image (JPEG/PNG/FITS), <strong>finds stars</strong>,
        <strong>plate-solves</strong> to figure out where you’re pointed, <strong>cross-matches</strong> detections with Gaia DR3,
        and then estimates a <strong>limiting magnitude</strong> to infer light pollution / sky quality.
        I’ve attached an early prototype on GitHub: 
        <a href="https://github.com/ethanw5667-hue/astrosolver" target="_blank" rel="noopener">astrosolver</a>.
      </p>

      <!-- ========= Slides (inline) ========= -->
      <h3>Slides</h3>
      <div class="slides-wrap">
        <div class="slides-toolbar">
          <a class="btn" href="../assets/Astro_Sky_Solver.pdf" download>Download PDF</a>
          <a class="btn ghost" href="../assets/Astro_Sky_Solver.pdf" target="_blank" rel="noopener">Open in new tab</a>
          <span class="refs">I’ll keep this updated as the solver improves.</span>
        </div>

      <h3>How the star detection works</h3>
      <p>
        Detection uses a classic astronomy pipeline (Astropy + Photutils), tuned for phone and DSLR images:
      </p>
      <ul>
        <li><strong>Background modeling.</strong> A sigma-clipped 2D median background removes sky glow and gradients.</li>
        <li><strong>Source extraction.</strong> <span class="code">DAOStarFinder</span> locates point-like peaks using an
            approximate <em>FWHM</em> (in pixels) and a threshold of <em>k</em>·σ above the background RMS.</li>
        <li><strong>Ranking.</strong> Detections are sorted by flux; centroids are sub-pixel refined.</li>
      </ul>

      <div class="figure">
        <img src="../assets/sample_detections_overlay.png" alt="Overlay of detected stars (circles) and matches (crosses)">
        <small>Detector output over a Milky Way field. Red/green overlays show detected peaks and matched catalog stars.</small>
      </div>

      <h3>Plate solving: figuring out where the camera is pointed</h3>
      <p>
        If the image is not already a WCS-calibrated FITS, I resolve it using
        <a href="https://nova.astrometry.net" target="_blank" rel="noopener">Astrometry.net</a>
        (web API with a key) or a local <span class="code">solve-field</span>. The result is a FITS with WCS keywords
        that map pixels → (RA, Dec). With WCS in hand, every detection becomes a sky coordinate.
      </p>

      <div class="figure">
        <img src="../assets/sample_constellations_1.png" alt="Constellation overlay on solved image">
        <small>After WCS, it’s trivial to overlay constellation lines/labels from standard catalogs.</small>
      </div>

      <h3>Identifying stars: Gaia DR3 cross-match</h3>
      <p>
        I query <strong>Gaia DR3</strong> around the field center (radius padded by ~5%) and perform a nearest-neighbor match
        in sky coordinates. Each detection brings back Gaia IDs and G-band magnitudes for calibration.
      </p>

      <h3>Estimating limiting magnitude & sky quality</h3>
      <p>From the matched stars, I estimate a photometric zero-point and then infer the faintest magnitude detectable:</p>
      <ol>
        <li><strong>Zero-point (ZP).</strong> For each match with flux <em>F</em> and Gaia G magnitude <em>G</em>, compute the instrumental magnitude
          <span class="code">m_inst = −2.5 log10(F)</span>, then take the median of <span class="code">ZP_i = G − m_inst</span>.</li>
        <li><strong>Detection threshold.</strong> The minimum detectable flux is modeled as
          <span class="code">F_min ≈ SNR_th · √N_pix · σ_bkg</span>, with <span class="code">N_pix ≈ π(FWHM/2)^2</span>.</li>
        <li><strong>Limiting magnitude (observed).</strong>
          <span class="code">G_lim = ZP − 2.5 log10(F_min)</span>.</li>
        <li><strong>Airmass/Extinction (optional).</strong> If location & time are given, I compute airmass <em>X</em> for the field center
          and apply a broadband extinction correction:
          <span class="code">G_lim,zenith ≈ G_lim + k_G (X − 1)</span> (typical <span class="code">k_G ≈ 0.15</span> mag/airmass).</li>
      </ol>
      <div class="callout">
        <strong>Sky quality.</strong> I map the limiting magnitude to a rough Bortle-like class for a quick “how dark is it?” readout.
        It’s not a replacement for calibrated SQM meters, but it’s surprisingly informative for outreach and site checks.
      </div>

      <div class="figure">
        <img src="../assets/sample_milkyway_1.jpg" alt="Milky Way sample frame used for solver demo">
        <small>Sample frame used for the solver demo.</small>
      </div>

      <h3>Repository & prototype</h3>
      <p>
        Code and examples live here:
        <a href="https://github.com/ethanw5667-hue/astrosolver" target="_blank" rel="noopener">github.com/ethanw5667-hue/astrosolver</a>.
        The current build includes a CLI, sample images, annotated outputs, and the limiting-magnitude estimator.
      </p>

      <h3>What’s next</h3>
      <ul>
        <li>Phone sensor/exposure heuristics to auto-tune the detection threshold.</li>
        <li>Optional photometric color terms (G↔V) and extinction lookup by site elevation.</li>
        <li>On-device constellation overlay and AR horizon masking.</li>
      </ul>

      <!-- ======= Asset placeholders you'll add later ======= -->
      <!-- Put your files in ../assets/ and keep names below or edit src paths above -->
      <!--
        ../assets/Astro_Sky_Solver.pdf
        ../assets/astro_detections_overlay.png
        ../assets/astro_constellations_overlay.png
        ../assets/astro_milkyway_sample.jpg
      -->

    </div>
  </section>
</main>

<footer class="site-footer">
  <div class="container">© <span id="year"></span> Ethan Wang</div>
</footer>
<script src="../script.js"></script>
</body>
</html>
